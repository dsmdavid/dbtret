models:
  - name: customer_day
    description: Grain customer and day, with flags for new,upsell,downsell,churn,reactivate
    docs:
      node_color: DeepPink
    columns:
      - name: customer_id
        description: Numeric field that uniquely identifies each customer. Derived from the 'customer_id' column in the 'raw.manual.activity'
          table.
        data_type: number
      - name: current_dt
        description: This is a date field that represents the calendar date for each record.
        data_type: date
      - name: customer_day_sk
        description: This is a varchar field that serves as a surrogate key for the
          'customer_day' model. It is generated by using dbt surrogate key with 'customer_id' and 'current_dt'.
        data_type: varchar
        data_tests:
          - unique
          - not_null
      - name: n_subscriptions
        description: Number of distinct subscriptions
          associated with a specific customer on a given day. It is calculated
          by counting the distinct subscription_id for each customer_id and
          current_dt in the expanded_calendar derived table.
        data_type: number
      - name: n_subscriptions_prev_day
        description: Number of distinct subscriptions for a given customer on the previous day, used to identify new/upsell/churn/etc.
        data_type: number
      - name: is_new
        description: Indicates whether the customer is new or not.
          It is determined by checking if the number of subscriptions on the
          previous day is null. If it is null, the customer is considered new
          and the field is set to true. Otherwise, it is set to false.
        data_type: boolean
      - name: is_upsell
        description: Indicates whether an upsell has occurred. It
          is determined by checking if the customer is not new and the number of
          subscriptions on the current day is greater than the number of
          subscriptions on the previous day. If these conditions are met, an
          upsell has occurred and the field is set to true. Otherwise, it is set
          to false.
        data_type: boolean
      - name: is_downsell
        description: Indicates whether a downsell has occurred. It
          is determined by checking if the customer is not new and the number of
          subscriptions on the current day is less than the number of
          subscriptions on the previous day. If these conditions are met, a
          downsell has occurred and the field is set to true. Otherwise, it is
          set to false.
        data_type: boolean
      - name: is_churn
        description: Indicates whether a customer has churned. This
          is determined by checking if the number of subscriptions
          (n_subscriptions) is equal to 0. If it is, the customer is considered
          to have churned and the field is set to true. Otherwise, it is set to
          false.
        data_type: boolean
      - name: is_reactivate
        description: Indicates whether a customer has reactivated
          their account. This is determined by checking if the customer is not
          new (is_new is false), the number of subscriptions on the previous day
          (n_subscriptions_prev_day) was 0, and the current number of
          subscriptions (n_subscriptions) is greater than 0. If all these
          conditions are met, the customer is considered to have reactivated
          their account and the field is set to true. Otherwise, it is set to
          false.
        data_type: boolean
